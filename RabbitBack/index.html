<!DOCTYPE html>
<html>
<head>
    <title>Chat Test</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", (event) => {
            var usernameInput = document.getElementById('username');
            var connectButton = document.getElementById('connect');
            var disconnectButton = document.getElementById('disconnect');
            var messageInput = document.getElementById('message');
            var sendButton = document.getElementById('send');
            var socket;

            connectButton.addEventListener('click', function() {
                var username = usernameInput.value;
                socket = io.connect('http://localhost:5000?username=' + encodeURIComponent(username));

                socket.on('connect', function() {
                    console.log('Connected to the server');
                    connectButton.disabled = true;  // Disable the connect button
                    disconnectButton.disabled = false;  // Enable the disconnect button
                });

                socket.on('disconnect', function() {
                    console.log('Disconnected from the server');
                    connectButton.disabled = false;  // Enable the connect button
                    disconnectButton.disabled = true;  // Disable the disconnect button
                });

                // Listen for a 'message' event from the server
                socket.on('message', function(message) {
                    console.log('Received a message: ', message);
                    const messageElement = document.createElement('p');
                    messageElement.textContent = `${message.username}: ${message.content}`;
                    document.body.appendChild(messageElement);
                });
            });

            disconnectButton.addEventListener('click', function() {
                socket.disconnect();
            });

            sendButton.addEventListener('click', function() {
                var message = messageInput.value;
                socket.emit('message', message);
                messageInput.value = '';
            });
        });
    </script>
</head>
<body>
    <h1>Chat Test</h1>
    <input id="username" type="text" placeholder="Enter your username">
    <button id="connect">Connect</button>
    <button id="disconnect" disabled>Disconnect</button>
    <input id="message" type="text" placeholder="Enter your message">
    <button id="send">Send</button>
</body>
</html>